{% extends "base.html" %}

{% block title %}Edit Version {{ version.version }} - Prompt Management System{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Home</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('prompt_detail', prompt_id=version.prompt_id) }}">{{ version.prompt_def.prompt_type.title() }}</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('version_detail', version_id=version.id) }}">Version {{ version.version }}</a></li>
                <li class="breadcrumb-item active">Edit</li>
            </ol>
        </nav>

        <div class="card">
            <div class="card-header">
                <h2 class="mb-0">
                    <i class="fas fa-edit"></i> Edit Version {{ version.version }}
                    <span class="badge bg-warning ms-2">{{ version.status }}</span>
                </h2>
            </div>
            <div class="card-body">
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <strong>Editing Draft Version:</strong>
                    <ul class="mb-0 mt-2">
                        <li><strong>Prompt Type:</strong> {{ version.prompt_def.prompt_type.title() }}</li>
                        <li><strong>Version:</strong> {{ version.version }}</li>
                        <li><strong>Status:</strong> {{ version.status }}</li>
                        <li><strong>Created:</strong> {{ version.createddate.strftime('%Y-%m-%d %H:%M:%S') }}</li>
                    </ul>
                </div>

                <form method="POST">
                    <div class="mb-3">
                        <label for="prompt_value" class="form-label">Prompt Value <span class="text-danger">*</span></label>
                        <textarea class="form-control" id="prompt_value" name="prompt_value" rows="10" required>{{ version.prompt_value }}</textarea>
                        <div class="form-text">
                            <i class="fas fa-info-circle"></i>
                            You can only edit the prompt value when the version is in draft status.
                        </div>
                    </div>

                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <strong>Important:</strong>
                        <ul class="mb-0 mt-2">
                            <li>Only versions in <strong>draft</strong> status can be edited</li>
                            <li>Once published, versions become read-only</li>
                            <li>Changes will be saved immediately</li>
                        </ul>
                    </div>

                    <div class="d-flex justify-content-between">
                        <a href="{{ url_for('version_detail', version_id=version.id) }}" class="btn btn-secondary">
                            <i class="fas fa-times"></i> Cancel
                        </a>
                        <button type="submit" class="btn btn-warning">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}